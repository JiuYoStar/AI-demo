# è‡ªåŠ¨æ³¨å†Œè“å›¾åŠŸèƒ½è¯´æ˜

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

é¡¹ç›®å·²å®ç°**è‡ªåŠ¨æ‰«æå¹¶æ³¨å†Œè“å›¾**åŠŸèƒ½,æ— éœ€æ‰‹åŠ¨å¯¼å…¥å’Œæ³¨å†Œæ¯ä¸ªè“å›¾,åªéœ€å°†è“å›¾æ–‡ä»¶æ”¾åœ¨ `app/blueprints/` ç›®å½•ä¸‹å³å¯è‡ªåŠ¨æ³¨å†Œã€‚

## âœ¨ ä¼˜åŠ¿

### âŒ ä¼ ç»Ÿæ–¹å¼(æ‰‹åŠ¨æ³¨å†Œ)

```python
# app/__init__.py
from app.blueprints.user import user_bp
from app.blueprints.admin import admin_bp
from app.blueprints.api import api_v1_bp, api_v2_bp

app.register_blueprint(user_bp)
app.register_blueprint(admin_bp)
app.register_blueprint(api_v1_bp)
app.register_blueprint(api_v2_bp)
```

**ç¼ºç‚¹**:
- âŒ æ¯æ·»åŠ ä¸€ä¸ªè“å›¾éƒ½è¦æ‰‹åŠ¨å¯¼å…¥
- âŒ æ¯æ·»åŠ ä¸€ä¸ªè“å›¾éƒ½è¦æ‰‹åŠ¨æ³¨å†Œ
- âŒ ä»£ç é‡å¤,å®¹æ˜“é—æ¼
- âŒ ä¸åˆ©äºæ¨¡å—åŒ–å¼€å‘

### âœ… è‡ªåŠ¨æ³¨å†Œæ–¹å¼

```python
# app/__init__.py
auto_register_blueprints(app)
```

**ä¼˜ç‚¹**:
- âœ… è‡ªåŠ¨æ‰«æ `app/blueprints/` ç›®å½•
- âœ… è‡ªåŠ¨å¯¼å…¥æ‰€æœ‰è“å›¾æ¨¡å—
- âœ… è‡ªåŠ¨æ³¨å†Œæ‰€æœ‰Blueprintå®ä¾‹
- âœ… æ·»åŠ æ–°è“å›¾æ— éœ€ä¿®æ”¹ä»£ç 
- âœ… æ”¯æŒä¸€ä¸ªæ–‡ä»¶å¤šä¸ªè“å›¾

## ğŸ”§ å·¥ä½œåŸç†

### 1. æ‰«æç›®å½•

```python
# æ‰«æ app/blueprints/ ç›®å½•ä¸‹çš„æ‰€æœ‰.pyæ–‡ä»¶
# æ’é™¤ __init__.py å’Œä»¥_å¼€å¤´çš„æ–‡ä»¶
blueprint_files = [
    f for f in blueprints_path.glob('*.py')
    if f.name != '__init__.py' and not f.name.startswith('_')
]
```

### 2. åŠ¨æ€å¯¼å…¥

```python
# å¯¹æ¯ä¸ªæ–‡ä»¶åŠ¨æ€å¯¼å…¥æ¨¡å—
module_path = f'app.blueprints.{module_name}'
module = importlib.import_module(module_path)
```

### 3. æŸ¥æ‰¾Blueprintå®ä¾‹

```python
# éå†æ¨¡å—çš„æ‰€æœ‰å±æ€§
for attr_name in dir(module):
    attr = getattr(module, attr_name)

    # æ£€æŸ¥æ˜¯å¦æ˜¯Blueprintå®ä¾‹
    if isinstance(attr, Blueprint):
        blueprints_found.append((attr_name, attr))
```

### 4. è‡ªåŠ¨æ³¨å†Œ

```python
# æ³¨å†Œæ‰¾åˆ°çš„æ‰€æœ‰è“å›¾
for bp_name, bp in blueprints_found:
    app.register_blueprint(bp)
```

## ğŸ“‹ ä½¿ç”¨æ–¹æ³•

### 1. åˆ›å»ºè“å›¾æ–‡ä»¶

åœ¨ `app/blueprints/` ç›®å½•ä¸‹åˆ›å»ºæ–°çš„è“å›¾æ–‡ä»¶:

```python
# app/blueprints/product.py
from flask import Blueprint, jsonify

product_bp = Blueprint('product', __name__, url_prefix='/product')

@product_bp.route('/')
def product_index():
    return jsonify({'message': 'Product Index'})

@product_bp.route('/<int:product_id>')
def product_detail(product_id):
    return jsonify({'product_id': product_id})
```

### 2. å¯åŠ¨åº”ç”¨

```bash
python run.py
```

### 3. æŸ¥çœ‹æ³¨å†Œç»“æœ

å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ˜¾ç¤º:

```
============================================================
ğŸ” è‡ªåŠ¨æ‰«æå¹¶æ³¨å†Œè“å›¾...
============================================================

ğŸ“ æ‰«ææ¨¡å—: app.blueprints.user
  âœ… æ³¨å†Œè“å›¾: user_bp              â†’ URLå‰ç¼€: /user

ğŸ“ æ‰«ææ¨¡å—: app.blueprints.admin
  âœ… æ³¨å†Œè“å›¾: admin_bp             â†’ URLå‰ç¼€: /admin

ğŸ“ æ‰«ææ¨¡å—: app.blueprints.product
  âœ… æ³¨å†Œè“å›¾: product_bp           â†’ URLå‰ç¼€: /product

ğŸ“ æ‰«ææ¨¡å—: app.blueprints.api
  âœ… æ³¨å†Œè“å›¾: api_v1_bp            â†’ URLå‰ç¼€: /api/v1
  âœ… æ³¨å†Œè“å›¾: api_v2_bp            â†’ URLå‰ç¼€: /api/v2

============================================================
âœ¨ è“å›¾æ³¨å†Œå®Œæˆ! å…±æ³¨å†Œ 5 ä¸ªè“å›¾
============================================================
```

## ğŸ¨ æ”¯æŒçš„åœºæ™¯

### åœºæ™¯1: ä¸€ä¸ªæ–‡ä»¶ä¸€ä¸ªè“å›¾

```python
# app/blueprints/user.py
user_bp = Blueprint('user', __name__, url_prefix='/user')
```

### åœºæ™¯2: ä¸€ä¸ªæ–‡ä»¶å¤šä¸ªè“å›¾

```python
# app/blueprints/api.py
api_v1_bp = Blueprint('api_v1', __name__, url_prefix='/api/v1')
api_v2_bp = Blueprint('api_v2', __name__, url_prefix='/api/v2')

# ä¸¤ä¸ªè“å›¾éƒ½ä¼šè¢«è‡ªåŠ¨æ³¨å†Œ
```

### åœºæ™¯3: ç¦ç”¨æŸä¸ªè“å›¾

```python
# æ–¹å¼1: æ–‡ä»¶åä»¥_å¼€å¤´(ä¸ä¼šè¢«æ‰«æ)
# app/blueprints/_disabled_feature.py

# æ–¹å¼2: åˆ é™¤æˆ–ç§»åŠ¨æ–‡ä»¶
# mv app/blueprints/old_feature.py app/blueprints/backup/
```

## ğŸ“Š å®é™…ç¤ºä¾‹

### å½“å‰é¡¹ç›®ç»“æ„

```
app/blueprints/
â”œâ”€â”€ __init__.py          # ä¸ä¼šè¢«æ‰«æ
â”œâ”€â”€ user.py             # âœ… æ‰«æ â†’ user_bp
â”œâ”€â”€ admin.py            # âœ… æ‰«æ â†’ admin_bp
â””â”€â”€ api.py              # âœ… æ‰«æ â†’ api_v1_bp, api_v2_bp
```

### æ³¨å†Œç»“æœ

| æ–‡ä»¶ | è“å›¾å®ä¾‹ | URLå‰ç¼€ | çŠ¶æ€ |
|------|---------|---------|------|
| user.py | user_bp | /user | âœ… å·²æ³¨å†Œ |
| admin.py | admin_bp | /admin | âœ… å·²æ³¨å†Œ |
| api.py | api_v1_bp | /api/v1 | âœ… å·²æ³¨å†Œ |
| api.py | api_v2_bp | /api/v2 | âœ… å·²æ³¨å†Œ |

## ğŸ” è°ƒè¯•å’ŒéªŒè¯

### æŸ¥çœ‹æ‰€æœ‰æ³¨å†Œçš„è“å›¾

```python
from app import app

# æŸ¥çœ‹è“å›¾å­—å…¸
print(app.blueprints)
# è¾“å‡º: {'user': <Blueprint 'user'>, 'admin': <Blueprint 'admin'>, ...}

# éå†æ‰€æœ‰è“å›¾
for name, blueprint in app.blueprints.items():
    print(f"è“å›¾: {name}, URLå‰ç¼€: {blueprint.url_prefix}")
```

### æŸ¥çœ‹æ‰€æœ‰è·¯ç”±

```python
from app import app

for rule in app.url_map.iter_rules():
    print(f"{rule.endpoint:35s} {rule.rule}")
```

### ä½¿ç”¨æµ‹è¯•è„šæœ¬

```bash
# è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯æ‰€æœ‰è·¯ç”±
python test_blueprints.py
```

## âš™ï¸ é…ç½®é€‰é¡¹

### è‡ªå®šä¹‰è“å›¾ç›®å½•

```python
# app/__init__.py
# é»˜è®¤æ‰«æ app/blueprints/
auto_register_blueprints(app)

# è‡ªå®šä¹‰ç›®å½•
auto_register_blueprints(app, blueprints_dir='app/modules')
```

### ç¦ç”¨è‡ªåŠ¨æ³¨å†Œ(å›åˆ°æ‰‹åŠ¨æ¨¡å¼)

```python
# æ³¨é‡Šæ‰è‡ªåŠ¨æ³¨å†Œ
# auto_register_blueprints(app)

# æ”¹ä¸ºæ‰‹åŠ¨æ³¨å†Œ
from app.blueprints.user import user_bp
app.register_blueprint(user_bp)
```

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1: è“å›¾æœªè¢«æ³¨å†Œ

**å¯èƒ½åŸå› **:
- æ–‡ä»¶åä»¥ `_` å¼€å¤´
- æ–‡ä»¶åæ˜¯ `__init__.py`
- æ–‡ä»¶ä¸åœ¨ `app/blueprints/` ç›®å½•
- æ¨¡å—ä¸­æ²¡æœ‰Blueprintå®ä¾‹

**è§£å†³æ–¹æ³•**:
```bash
# æ£€æŸ¥æ–‡ä»¶ä½ç½®
ls app/blueprints/

# æŸ¥çœ‹å¯åŠ¨æ—¥å¿—
python run.py
# æŸ¥çœ‹æ˜¯å¦æœ‰ "âœ… æ³¨å†Œè“å›¾" çš„è¾“å‡º
```

### é—®é¢˜2: å¯¼å…¥é”™è¯¯

**å¯èƒ½åŸå› **:
- æ¨¡å—ä¸­æœ‰è¯­æ³•é”™è¯¯
- æ¨¡å—ä¾èµ–æœªå®‰è£…
- å¾ªç¯å¯¼å…¥

**è§£å†³æ–¹æ³•**:
```python
# æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
python run.py
# æŸ¥çœ‹æ˜¯å¦æœ‰ "âŒ å¯¼å…¥å¤±è´¥" çš„è¾“å‡º

# æ‰‹åŠ¨æµ‹è¯•å¯¼å…¥
python -c "from app.blueprints.user import user_bp"
```

### é—®é¢˜3: è·¯ç”±å†²çª

**å¯èƒ½åŸå› **:
- å¤šä¸ªè“å›¾ä½¿ç”¨ç›¸åŒçš„URLå‰ç¼€
- è·¯ç”±è§„åˆ™é‡å¤

**è§£å†³æ–¹æ³•**:
```python
# æ£€æŸ¥æ‰€æœ‰è·¯ç”±
from app import app
for rule in app.url_map.iter_rules():
    print(rule.rule)
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. è“å›¾å‘½åè§„èŒƒ

```python
# âœ… æ¨è: ä½¿ç”¨ _bp åç¼€
user_bp = Blueprint('user', __name__)
admin_bp = Blueprint('admin', __name__)

# âŒ ä¸æ¨è: ä¸æ¸…æ™°çš„å‘½å
bp1 = Blueprint('bp1', __name__)
my_blueprint = Blueprint('my', __name__)
```

### 2. æ–‡ä»¶ç»„ç»‡

```python
# âœ… æ¨è: ä¸€ä¸ªåŠŸèƒ½æ¨¡å—ä¸€ä¸ªæ–‡ä»¶
app/blueprints/
â”œâ”€â”€ user.py      # ç”¨æˆ·ç›¸å…³
â”œâ”€â”€ admin.py     # ç®¡ç†å‘˜ç›¸å…³
â”œâ”€â”€ product.py   # äº§å“ç›¸å…³
â””â”€â”€ order.py     # è®¢å•ç›¸å…³

# âœ… ä¹Ÿå¯ä»¥: ç›¸å…³åŠŸèƒ½æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶
app/blueprints/
â””â”€â”€ api.py       # api_v1_bp, api_v2_bp
```

### 3. URLå‰ç¼€è®¾è®¡

```python
# âœ… æ¨è: æ¸…æ™°çš„URLç»“æ„
user_bp = Blueprint('user', __name__, url_prefix='/user')
admin_bp = Blueprint('admin', __name__, url_prefix='/admin')
api_v1_bp = Blueprint('api_v1', __name__, url_prefix='/api/v1')

# âŒ é¿å…: æ··ä¹±çš„URLç»“æ„
bp1 = Blueprint('bp1', __name__, url_prefix='/x')
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Blueprintè“å›¾ä½¿ç”¨æ‰‹å†Œ.md](./Blueprintè“å›¾ä½¿ç”¨æ‰‹å†Œ.md) - è“å›¾è¯¦ç»†æ•™ç¨‹
- [Blueprintå¿«é€Ÿå‚è€ƒ.md](./Blueprintå¿«é€Ÿå‚è€ƒ.md) - è“å›¾å¿«é€ŸæŸ¥è¯¢
- [é¡¹ç›®è¯´æ˜.md](./é¡¹ç›®è¯´æ˜.md) - é¡¹ç›®æ•´ä½“ä»‹ç»

## ğŸ‰ æ€»ç»“

è‡ªåŠ¨æ³¨å†Œè“å›¾åŠŸèƒ½è®©Flaskåº”ç”¨çš„æ¨¡å—åŒ–å¼€å‘æ›´åŠ ä¾¿æ·:

- âœ… **é›¶é…ç½®**: åˆ›å»ºè“å›¾æ–‡ä»¶å³å¯,æ— éœ€æ‰‹åŠ¨æ³¨å†Œ
- âœ… **è‡ªåŠ¨å‘ç°**: è‡ªåŠ¨æ‰«æå¹¶æ³¨å†Œæ‰€æœ‰è“å›¾
- âœ… **çµæ´»æ‰©å±•**: æ”¯æŒä»»æ„æ•°é‡çš„è“å›¾
- âœ… **æ¸…æ™°å¯è§**: å¯åŠ¨æ—¶æ˜¾ç¤ºæ‰€æœ‰æ³¨å†Œçš„è“å›¾
- âœ… **æ˜“äºè°ƒè¯•**: è¯¦ç»†çš„æ³¨å†Œæ—¥å¿—

ç°åœ¨ä½ å¯ä»¥ä¸“æ³¨äºå¼€å‘è“å›¾åŠŸèƒ½,è€Œä¸ç”¨æ‹…å¿ƒæ³¨å†Œçš„é—®é¢˜! ğŸš€

