# flask-demo1 é¡¹ç›®è¯´æ˜

## ğŸ“– é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªFlaskåº”ç”¨ç¤ºä¾‹é¡¹ç›®,æ¼”ç¤ºäº†Flaskçš„æ ¸å¿ƒåŠŸèƒ½å’Œæœ€ä½³å®è·µ,åŒ…æ‹¬:

- âœ… Flaskåº”ç”¨åŸºæœ¬ç»“æ„
- âœ… è·¯ç”±å’Œè§†å›¾å‡½æ•°
- âœ… è¯·æ±‚ä¸Šä¸‹æ–‡(gå¯¹è±¡)
- âœ… è“å›¾(Blueprint)æ¨¡å—åŒ–
- âœ… APIç‰ˆæœ¬æ§åˆ¶
- âœ… è™šæ‹Ÿç¯å¢ƒé…ç½®
- âœ… IDEå¼€å‘ç¯å¢ƒè®¾ç½®

## ğŸ—‚ï¸ é¡¹ç›®ç»“æ„

```
test/
â”œâ”€â”€ app/                          # åº”ç”¨ä¸»ç›®å½•
â”‚   â”œâ”€â”€ __init__.py              # Flaskåº”ç”¨å®ä¾‹,æ³¨å†Œè“å›¾
â”‚   â”œâ”€â”€ views.py                 # ä¸»è§†å›¾è·¯ç”±
â”‚   â”œâ”€â”€ auth.py                  # è®¤è¯è·¯ç”±
â”‚   â”œâ”€â”€ models.py                # æ•°æ®æ¨¡å‹(é¢„ç•™)
â”‚   â””â”€â”€ blueprints/              # è“å›¾æ¨¡å—ç›®å½•
â”‚       â”œâ”€â”€ __init__.py          # è“å›¾åŒ…åˆå§‹åŒ–
â”‚       â”œâ”€â”€ user.py              # ç”¨æˆ·åŠŸèƒ½è“å›¾
â”‚       â”œâ”€â”€ admin.py             # ç®¡ç†å‘˜åŠŸèƒ½è“å›¾
â”‚       â””â”€â”€ api.py               # APIæ¥å£è“å›¾(v1/v2)
â”‚
â”œâ”€â”€ document/                     # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ README.md                # é¡¹ç›®è¯´æ˜(å·²ç§»åŠ¨åˆ°æ­¤)
â”‚   â”œâ”€â”€ Config.md                # ç¯å¢ƒé…ç½®è¯´æ˜(å·²ç§»åŠ¨åˆ°æ­¤)
â”‚   â”œâ”€â”€ IDEé…ç½®è¯´æ˜.md           # IDEè®¾ç½®æŒ‡å—(å·²ç§»åŠ¨åˆ°æ­¤)
â”‚   â”œâ”€â”€ Blueprintè“å›¾ä½¿ç”¨æ‰‹å†Œ.md  # è“å›¾è¯¦ç»†æ•™ç¨‹
â”‚   â”œâ”€â”€ Blueprintå¿«é€Ÿå‚è€ƒ.md     # è“å›¾å¿«é€ŸæŸ¥è¯¢
â”‚   â””â”€â”€ é¡¹ç›®è¯´æ˜.md              # æœ¬æ–‡ä»¶
â”‚
â”œâ”€â”€ venv/                        # è™šæ‹Ÿç¯å¢ƒ(ä¸æäº¤åˆ°Git)
â”‚
â”œâ”€â”€ .vscode/                     # VS Codeé…ç½®
â”‚   â”œâ”€â”€ settings.json           # Pythonè§£é‡Šå™¨é…ç½®
â”‚   â””â”€â”€ launch.json             # è°ƒè¯•é…ç½®
â”‚
â”œâ”€â”€ run.py                       # åº”ç”¨å¯åŠ¨å…¥å£
â”œâ”€â”€ requirements.txt             # Pythonä¾èµ–åˆ—è¡¨
â”œâ”€â”€ .gitignore                   # Gitå¿½ç•¥é…ç½®
â””â”€â”€ .python-version              # Pythonç‰ˆæœ¬æ ‡è¯†

```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å…‹éš†æˆ–è¿›å…¥é¡¹ç›®ç›®å½•
cd /Users/lingk/work/py/demo/test

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate  # macOS/Linux
# æˆ–
venv\Scripts\activate     # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. è¿è¡Œåº”ç”¨

```bash
# ç¡®ä¿è™šæ‹Ÿç¯å¢ƒå·²æ¿€æ´»
python run.py

# åº”ç”¨å°†åœ¨ http://127.0.0.1:5000 å¯åŠ¨
```

### 3. æµ‹è¯•è·¯ç”±

```bash
# ä¸»é¡µ
curl http://127.0.0.1:5000/

# ç™»å½•é¡µ
curl http://127.0.0.1:5000/login

# ç”¨æˆ·è“å›¾
curl http://127.0.0.1:5000/user/
curl http://127.0.0.1:5000/user/profile

# ç®¡ç†å‘˜è“å›¾
curl http://127.0.0.1:5000/admin/dashboard

# APIæ¥å£
curl http://127.0.0.1:5000/api/v1/posts
curl http://127.0.0.1:5000/api/v2/posts
```

## ğŸ“‹ åŠŸèƒ½æ¨¡å—

### 1. ä¸»åº”ç”¨è·¯ç”± (views.py, auth.py)

- **é¦–é¡µ** (`/`): æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯,æ”¯æŒç”¨æˆ·å‚æ•°
- **ç™»å½•é¡µ** (`/login`): ç™»å½•é¡µé¢ç¤ºä¾‹

### 2. ç”¨æˆ·è“å›¾ (blueprints/user.py)

URLå‰ç¼€: `/user`

- ç”¨æˆ·é¦–é¡µ
- ç”¨æˆ·èµ„æ–™æŸ¥çœ‹
- ç”¨æˆ·è®¾ç½®ç®¡ç†

### 3. ç®¡ç†å‘˜è“å›¾ (blueprints/admin.py)

URLå‰ç¼€: `/admin`

- ç®¡ç†åå°é¦–é¡µ
- ä»ªè¡¨ç›˜ç»Ÿè®¡
- ç”¨æˆ·ç®¡ç†(åˆ—è¡¨ã€è¯¦æƒ…ã€ç¼–è¾‘ã€åˆ é™¤)
- ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯

### 4. APIè“å›¾ (blueprints/api.py)

**API v1** - URLå‰ç¼€: `/api/v1`
- åŸºç¡€æ–‡ç« æ¥å£

**API v2** - URLå‰ç¼€: `/api/v2`
- å¢å¼ºçš„æ–‡ç« æ¥å£
- è¯„è®ºæ¥å£
- æ›´ä¸°å¯Œçš„æ•°æ®ç»“æ„

## ğŸ”‘ æ ¸å¿ƒæ¦‚å¿µ

### Flaskåº”ç”¨å®ä¾‹

```python
# app/__init__.py
from flask import Flask
app = Flask(__name__)
```

- æ•´ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ªFlaskå®ä¾‹
- æ‰€æœ‰è·¯ç”±å’Œè“å›¾éƒ½æ³¨å†Œåˆ°è¿™ä¸ªå®ä¾‹

### å¾ªç¯å¯¼å…¥è§£å†³æ–¹æ¡ˆ

```python
# å…ˆåˆ›å»ºappå®ä¾‹
app = Flask(__name__)

# ç„¶åå¯¼å…¥æ¨¡å—(é¿å…å¾ªç¯å¯¼å…¥)
from app import views, auth
from app.blueprints.user import user_bp
```

### è“å›¾(Blueprint)

```python
# åˆ›å»ºè“å›¾
user_bp = Blueprint('user', __name__, url_prefix='/user')

# æ³¨å†Œè“å›¾
app.register_blueprint(user_bp)
```

è“å›¾ç”¨äºæ¨¡å—åŒ–å¤§å‹åº”ç”¨,æ¯ä¸ªè“å›¾è´Ÿè´£ä¸€ä¸ªåŠŸèƒ½æ¨¡å—ã€‚

### è¯·æ±‚ä¸Šä¸‹æ–‡

```python
from flask import g, request

@app.before_request
def before_request():
    # gå¯¹è±¡åœ¨è¯·æ±‚æœŸé—´å…±äº«æ•°æ®
    g.user = request.args.get('user', 'Guest')
```

## ğŸ› ï¸ å¼€å‘ç¯å¢ƒ

### Pythonç‰ˆæœ¬
- Python 3.12.2 (é€šè¿‡pyenvç®¡ç†)

### ä¸»è¦ä¾èµ–
- Flask 3.1.2
- Werkzeug 3.1.3
- Jinja2 3.1.6
- Click 8.3.0

### IDEé…ç½®
- VS Code/Cursor
- Pythonæ‰©å±•
- Pylanceè¯­è¨€æœåŠ¡å™¨

è¯¦è§: [IDEé…ç½®è¯´æ˜.md](./IDEé…ç½®è¯´æ˜.md)

## ğŸ“š æ–‡æ¡£å¯¼èˆª

| æ–‡æ¡£ | è¯´æ˜ |
|------|------|
| [README.md](./README.md) | FlaskåŸºç¡€çŸ¥è¯†å’Œè·¯ç”±ç¤ºä¾‹ |
| [Config.md](./Config.md) | è™šæ‹Ÿç¯å¢ƒå’Œpipé…ç½®è¯¦è§£ |
| [IDEé…ç½®è¯´æ˜.md](./IDEé…ç½®è¯´æ˜.md) | è§£å†³IDEå¯¼å…¥é”™è¯¯é—®é¢˜ |
| [Blueprintè“å›¾ä½¿ç”¨æ‰‹å†Œ.md](./Blueprintè“å›¾ä½¿ç”¨æ‰‹å†Œ.md) | è“å›¾è¯¦ç»†æ•™ç¨‹ |
| [Blueprintå¿«é€Ÿå‚è€ƒ.md](./Blueprintå¿«é€Ÿå‚è€ƒ.md) | è“å›¾å¿«é€ŸæŸ¥è¯¢ |
| [é¡¹ç›®è¯´æ˜.md](./é¡¹ç›®è¯´æ˜.md) | æœ¬æ–‡ä»¶ |

## ğŸ¯ å­¦ä¹ è·¯å¾„

### åˆå­¦è€…
1. é˜…è¯» [README.md](./README.md) - äº†è§£FlaskåŸºç¡€
2. è¿è¡Œ `python run.py` - å¯åŠ¨åº”ç”¨
3. æµ‹è¯•å„ä¸ªè·¯ç”± - ç†è§£è·¯ç”±å·¥ä½œåŸç†
4. é˜…è¯» `app/views.py` å’Œ `app/auth.py` - å­¦ä¹ ç®€å•è·¯ç”±

### è¿›é˜¶
1. é˜…è¯» [Blueprintè“å›¾ä½¿ç”¨æ‰‹å†Œ.md](./Blueprintè“å›¾ä½¿ç”¨æ‰‹å†Œ.md)
2. æŸ¥çœ‹ `app/blueprints/` ç›®å½•ä¸‹çš„ä»£ç 
3. å°è¯•åˆ›å»ºè‡ªå·±çš„è“å›¾
4. ç†è§£APIç‰ˆæœ¬æ§åˆ¶çš„å®ç°

### ç¯å¢ƒé…ç½®
1. é˜…è¯» [Config.md](./Config.md) - è™šæ‹Ÿç¯å¢ƒè¯¦è§£
2. é˜…è¯» [IDEé…ç½®è¯´æ˜.md](./IDEé…ç½®è¯´æ˜.md) - IDEè®¾ç½®
3. é…ç½®è‡ªå·±çš„å¼€å‘ç¯å¢ƒ

## ğŸ” è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹æ‰€æœ‰è·¯ç”±

```python
from app import app

for rule in app.url_map.iter_rules():
    print(f"{rule.endpoint:35s} {rule.rule}")
```

### æŸ¥çœ‹è¯·æ±‚ä¿¡æ¯

```python
from flask import request

@app.before_request
def log_request():
    print(f"Method: {request.method}")
    print(f"Path: {request.path}")
    print(f"Args: {request.args}")
```

### ä½¿ç”¨è°ƒè¯•æ¨¡å¼

```python
# run.py
app.run(debug=True)  # è‡ªåŠ¨é‡è½½,è¯¦ç»†é”™è¯¯ä¿¡æ¯
```

## ğŸ› å¸¸è§é—®é¢˜

### Q: ModuleNotFoundError: No module named 'flask'
A: ç¡®ä¿å·²æ¿€æ´»è™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…äº†ä¾èµ–
```bash
source venv/bin/activate
pip install -r requirements.txt
```

### Q: IDEæ˜¾ç¤º"æ— æ³•è§£æå¯¼å…¥"
A: å‚è€ƒ [IDEé…ç½®è¯´æ˜.md](./IDEé…ç½®è¯´æ˜.md)

### Q: ç«¯å£è¢«å ç”¨
A: æ›´æ”¹ç«¯å£æˆ–æ€æ­»å ç”¨è¿›ç¨‹
```bash
# æŸ¥æ‰¾å ç”¨è¿›ç¨‹
lsof -i :5000
# æ€æ­»è¿›ç¨‹
kill -9 <PID>
```

### Q: è“å›¾è·¯ç”±404
A: æ£€æŸ¥è“å›¾æ˜¯å¦å·²æ³¨å†Œ
```python
# app/__init__.py
app.register_blueprint(user_bp)
```

## ğŸš§ åç»­æ‰©å±•

### å¯ä»¥æ·»åŠ çš„åŠŸèƒ½:
- [ ] æ•°æ®åº“é›†æˆ(SQLAlchemy)
- [ ] ç”¨æˆ·è®¤è¯(Flask-Login)
- [ ] è¡¨å•éªŒè¯(Flask-WTF)
- [ ] RESTful API(Flask-RESTful)
- [ ] å•å…ƒæµ‹è¯•(pytest)
- [ ] éƒ¨ç½²é…ç½®(Gunicorn + Nginx)

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜,è¯·æŸ¥çœ‹æ–‡æ¡£æˆ–å‚è€ƒFlaskå®˜æ–¹æ–‡æ¡£:
- [Flaskå®˜æ–¹æ–‡æ¡£](https://flask.palletsprojects.com/)
- [Flaskä¸­æ–‡æ–‡æ¡£](https://dormousehole.readthedocs.io/)

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ç”¨äºå­¦ä¹ å’Œæ¼”ç¤ºç›®çš„ã€‚

