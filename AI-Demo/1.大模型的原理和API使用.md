# ğŸ’¡ åƒé—®ï¼ˆQwenï¼‰ä¸å¼ºåŒ–å­¦ä¹ è¯¾ç¨‹ç¬”è®°



## ä¸€ã€Qwen è°ƒç”¨ä¸ç¯å¢ƒé…ç½®

### 1. QwenAuth æˆæƒ

* åœ¨èŠå¤©æ¡†ä¸­è¾“å…¥ï¼š`/auth`
* é€‰æ‹© **QwenAuth**
* æ¯å¤©æœ‰ **2000 æ¬¡å…è´¹äº¤äº’**
* å¦‚æœæç¤º *æ²¡æœ‰æƒé™* â†’ å»é‚®ç®±æŸ¥æ”¶ **æ¿€æ´»é‚®ä»¶** å¹¶ç‚¹å‡»ç¡®è®¤

### 2. DashScope å¹³å°

* å¹³å°åœ°å€ï¼š[https://dashscope.console.aliyun.com/model](https://dashscope.console.aliyun.com/model)

* Python SDK å®‰è£…ï¼š

  ```bash
  pip install dashscope
  ```

* ç¯å¢ƒå˜é‡è®¾ç½®ï¼š

  ```bash
  # macOS / Linux
  export DASHSCOPE_API_KEY="ä½ çš„API_KEY"

  # Windows
  setx DASHSCOPE_API_KEY "ä½ çš„API_KEY"
  ```

* ä»£ç ä¸­è¯»å–ï¼š

  ```python
  import os, dashscope
  dashscope.api_key = os.environ.get("DASHSCOPE_API_KEY")
  ```

* å¦‚æœè¯»å–ä¸åˆ° API Keyï¼š

  * æ£€æŸ¥ç¯å¢ƒå˜é‡åæ˜¯å¦æ­£ç¡®
  * é‡å¯ç»ˆç«¯æˆ– JupyterLab

### 3. å…è´¹é¢åº¦

* æ–°æ³¨å†Œç”¨æˆ·ï¼š30 å¤©å†… **100 ä¸‡å…è´¹ token**
* ä¹‹åéœ€æŒ‰é‡è®¡è´¹æˆ–ä½¿ç”¨ QwenAuth å…è´¹é¢åº¦

---

## äºŒã€æ¨¡å‹ã€å¼ºåŒ–å­¦ä¹ ä¸è®­ç»ƒæµç¨‹

### 1. å¼ºåŒ–å­¦ä¹ çš„æœ¬è´¨

å¼ºåŒ–å­¦ä¹ ï¼ˆReinforcement Learning, RLï¼‰é€šè¿‡ **æ‰“åˆ†ã€æ’åºï¼ˆrankingï¼‰åé¦ˆ** æ¥ä¼˜åŒ–æ¨¡å‹å‚æ•°ã€‚

* æ¨¡å‹ç»“æ„ï¼ˆå¦‚ 671B å‚æ•°ï¼‰**ä¸å˜**
* ä½†**å‚æ•°å†…éƒ¨æ•°å€¼**ä¼šéšç€åé¦ˆæ›´æ–°è€Œè°ƒæ•´

> ğŸ§  ç±»æ¯”ï¼šåƒå­¦ç”Ÿï¼ˆæ¨¡å‹ï¼‰åå¤è€ƒè¯•ï¼ˆç”Ÿæˆå›ç­”ï¼‰ï¼Œè€å¸ˆæ‰“åˆ†ï¼ˆå¥–åŠ±æ¨¡å‹ï¼‰ï¼Œå­¦ç”Ÿæ ¹æ®å¾—åˆ†è°ƒæ•´ç­”é¢˜ç­–ç•¥ã€‚

---

### 2. å¥–åŠ±æ¨¡å‹ï¼ˆReward Modelï¼‰

#### â‘  å¥–åŠ±æ¨¡å‹ä½œç”¨

* è®­ç»ƒå¼ºåŒ–å­¦ä¹ é˜¶æ®µçš„**æ‰“åˆ†å™¨**
* è¾“å…¥å¤šä¸ªå€™é€‰å›ç­” â†’ è¾“å‡ºæ’åºåˆ†æ•°ï¼ˆrankï¼‰

#### â‘¡ å¥–åŠ±æ¨¡å‹ä¸å¼ºåŒ–æ¨¡å‹çš„åŒºåˆ«

| é˜¶æ®µ                | æ¨¡å‹   | åŠŸèƒ½                     |
| ------------------- | ------ | ------------------------ |
| SFTï¼ˆç›‘ç£å¾®è°ƒï¼‰     | ä¸»æ¨¡å‹ | æ¨¡ä»¿äººç±»ä¼˜è´¨å›ç­”         |
| RMï¼ˆå¥–åŠ±æ¨¡å‹ï¼‰      | æ–°æ¨¡å‹ | å­¦ä¹ äººç±»çš„åå¥½æ’åº       |
| PPOï¼ˆå¼ºåŒ–å­¦ä¹ ä¼˜åŒ–ï¼‰ | ä¸»æ¨¡å‹ | æ ¹æ® RM å¥–åŠ±ä¿¡å·è°ƒæ•´å‚æ•° |

> âœ… å¥–åŠ±æ¨¡å‹å’Œä¼˜åŒ–æ¨¡å‹ **æ˜¯ä¸¤ä¸ªä¸åŒçš„æ¨¡å‹**
> å‰è€…ç»™åˆ†ï¼Œåè€…è°ƒæ•´ã€‚

---

### 3. Fine-tuning åœ¨å¤šé˜¶æ®µå­˜åœ¨

* **SFT**ï¼šç¬¬ä¸€é˜¶æ®µï¼Œæ¨¡ä»¿å­¦ä¹ 
* **RM è®­ç»ƒ**ï¼šè®­ç»ƒæ‰“åˆ†å™¨
* **RLHF**ï¼ˆå¼ºåŒ–å­¦ä¹ ï¼‰ä¸­ï¼šä¹Ÿå¯èƒ½å†æ¬¡ fine-tune æ¨¡å‹å‚æ•°
  æ‰€ä»¥ Fine-tuning ä¼šå‡ºç°åœ¨å¤šä¸ªé˜¶æ®µä¸­ã€‚

---

## ä¸‰ã€æ¨¡å‹äº¤äº’ä¸ä¸Šä¸‹æ–‡æœºåˆ¶

### 1. Token çª—å£é™åˆ¶

* æ¯ä¸ªæ¨¡å‹éƒ½æœ‰æœ€å¤§ä¸Šä¸‹æ–‡çª—å£ï¼ˆå¦‚ 200Kï¼‰
* è¶…è¿‡çª—å£çš„å†…å®¹ â†’ æ— æ³•ç»§ç»­æ¨ç†æˆ–ä¼šæŠ¥é”™
* å¯é€šè¿‡â€œ**æˆªæ–­æœ€è¿‘ N è½®å¯¹è¯**â€çš„æ–¹å¼ä¿ç•™ä¸Šä¸‹æ–‡

  ```python
  messages = messages[-5:]  # åªä¿ç•™æœ€è¿‘5è½®å¯¹è¯
  ```

### 2. æ–°å¼€å¯¹è¯ä¸ä¸Šä¸‹æ–‡

* æ–°å¼€å¯¹è¯ â‰ˆ æ–° sessionï¼Œæ²¡æœ‰å†å²ä¸Šä¸‹æ–‡
* è‹¥éœ€ä¿æŒè¿ç»­æ€§ â†’ å¯æ‰‹åŠ¨ä¿å­˜æœ€è¿‘ä¸Šä¸‹æ–‡å†ä¼ å…¥

---

## å››ã€Function ä¸ Tool è°ƒç”¨

| æ¦‚å¿µ     | ä½œç”¨                             | æ˜¯å¦ç­‰ä»· |
| -------- | -------------------------------- | -------- |
| Function | è®©å¤§æ¨¡å‹è°ƒç”¨è‡ªå®šä¹‰å‡½æ•°           | âœ…        |
| Tool     | è®©å¤§æ¨¡å‹ä½¿ç”¨å¤–éƒ¨å·¥å…·ï¼ˆAPI/ä»£ç ï¼‰ | âœ…        |

* äºŒè€…åŠŸèƒ½ç›¸åŒï¼Œåªæ˜¯å‘½åä¸åŒ
* å¯åœ¨å‡½æ•°ä¸­å°è£…å†…éƒ¨æˆ–å¤–éƒ¨ API è°ƒç”¨
* ç¤ºä¾‹ï¼š

  ```python
  def get_weather(city: str):
      # è°ƒç”¨å…¬å¸å†…éƒ¨API
      return requests.get(f"https://api.xxx.com/weather?city={city}")
  ```

---

## äº”ã€Jupyter ä¸ Python ç¯å¢ƒ

| æ–‡ä»¶     | å«ä¹‰                                |
| -------- | ----------------------------------- |
| `.py`    | çº¯ Python æºç                       |
| `.ipynb` | Jupyter Notebook æ–‡ä»¶ï¼ˆå«è¿è¡Œç»“æœï¼‰ |

* Jupyter è‡ªå¸¦ Python ç¯å¢ƒï¼Œé€‚åˆæ•™å­¦æ¼”ç¤º
* å¯åŠ¨ï¼š

  ```bash
  jupyter lab
  ```
* æ‰“å¼€å¯¹åº” `.ipynb` æ–‡ä»¶å³å¯è¿è¡Œç¤ºä¾‹

---

## å…­ã€Wucai å·¥å…·ä¸æœ¬åœ°ä½¿ç”¨

### 1. å®‰è£…

```bash
npm install -g @wucai/wucai-code@latest
# æˆ–
brew install wucai-code
```

### 2. å¯åŠ¨

```bash
wucai
```

### 3. ç™»å½•æˆæƒ

```
/auth â†’ QwenAuth
```

### 4. å®˜æ–¹åœ°å€

* GitHub: [https://github.com/cystanford/wucai-code](https://github.com/cystanford/wucai-code)
* è¯¾ç¨‹é“¾æ¥: [http://class.wucai.com](http://class.wucai.com)

---

## ä¸ƒã€å¸¸è§é—®é¢˜æ±‡æ€»

| é—®é¢˜                          | è§£ç­”                                                         |
| ----------------------------- | ------------------------------------------------------------ |
| è¶…å‡º token çª—å£æ€ä¹ˆåŠï¼Ÿ       | æˆªæ–­å†å²å¯¹è¯æˆ–æ–°å¼€ä¼šè¯                                       |
| func è¿”å›å¤ªå¤§æŠ¥é”™ï¼Ÿ           | åŒæ ·æ˜¯è¶…å‡ºä¸Šä¸‹æ–‡çª—å£                                         |
| cursor æç¤º â€œusage limitâ€ï¼Ÿ   | è¶…å‡ºæ¯æ—¥ token é™é¢                                          |
| Dashscope â€œæœªå¼€é€šâ€ï¼Ÿ          | è®¿é—® [https://class.wucai.com/#/3-dashscope](http://class.wucai.com/#/3-dashscope) |
| æœ¬åœ°éƒ¨ç½²è¿˜æ¶ˆè€— token å—ï¼Ÿ     | ä¸ä¼šæ¶ˆè€—å¤–éƒ¨ tokenï¼Œä½†ä»æœ‰å†…éƒ¨è®¡ç®—æ¶ˆè€—                       |
| temperature ä¸ top_p çš„å½±å“ï¼Ÿ | è¶Šä½ â†’ è¾“å‡ºæ›´ç¨³å®šï¼›è¶Šé«˜ â†’ æ›´å¤šæ ·åŒ–                           |
| å¤§æ¨¡å‹èƒ½å¦æ— é™å–‚æ•°æ®ï¼Ÿ        | å¯ä»¥ï¼Œä½†éœ€è¦è¶³å¤Ÿæ•°æ®ä¸ç®—åŠ›ï¼Œå¦åˆ™æ˜“è¿‡æ‹Ÿåˆ                     |
| æƒ…æ„Ÿåˆ†ææ²¡è¾“å‡ºï¼Ÿ              | æ£€æŸ¥æ˜¯å¦æœ‰ `print` æˆ– `return`                               |

---

## å…«ã€è®°å¿†æœºåˆ¶ä¸éšç§

* ChatGPT å¼€å¯è®°å¿†åŠŸèƒ½åï¼Œä¼šæ ¹æ®å¯¹è¯å†…å®¹åŠ¨æ€ç”Ÿæˆâ€œè®°å¿†ä½“â€
* è®°å¿†å†…å®¹ä¸æ˜¯å…¨éƒ¨ä¸Šä¸‹æ–‡ï¼Œè€Œæ˜¯ç»“æ„åŒ–ä¿¡æ¯ï¼ˆå¦‚ç”¨æˆ·åå¥½ã€é¡¹ç›®èƒŒæ™¯ï¼‰
* ç”¨æˆ·å¯æ§åˆ¶æ˜¯å¦ä¿å­˜æˆ–æ¸…é™¤è®°å¿†
* è‹¥è®°å¿†é”™è¯¯ï¼ˆå¦‚é”™è¯¯çš„åå­—ï¼‰â†’ å¯æ‰‹åŠ¨æ¸…é™¤

> âœ… **AI ä¸ä¼šè‡ªåŠ¨æ°¸ä¹…è®°å¿†**ï¼Œé™¤éç”¨æˆ·æ˜¾å¼æˆæƒã€‚

---

## ä¹ã€æ€»ç»“

* **ç›‘ç£å­¦ä¹  (SFT)**ï¼šAI æ¨¡ä»¿äººç±»ç­”æ¡ˆ
* **å¥–åŠ±æ¨¡å‹ (RM)**ï¼šAI å­¦ä¹ æ‰“åˆ†é€»è¾‘
* **å¼ºåŒ–å­¦ä¹  (RLHF)**ï¼šAI è‡ªæˆ‘ä¼˜åŒ–è¾“å‡º
* **Fine-tuning**ï¼šè´¯ç©¿å¤šä¸ªé˜¶æ®µ
* **Function Call / Tool Use**ï¼šè®© LLM å…·å¤‡â€œæ‰§è¡ŒåŠ›â€
* **ä¸Šä¸‹æ–‡çª—å£**ï¼šçº¦æŸå¯¹è¯é•¿åº¦
* **è®°å¿†ä½“**ï¼šå®šä¹‰é•¿æœŸä¿¡æ¯çš„å­˜å‚¨ç»´åº¦

---

ğŸ§­ æ¨èç»„åˆï¼š

> `Dashscope (Qwen)` + `Jupyter` + `Wucai`
> ä¸€å¥—å®Œæ•´çš„å¤§æ¨¡å‹è°ƒç”¨ä¸åº”ç”¨å¼€å‘ç¯å¢ƒã€‚

---



## åã€ä¸­æ–‡ vs è‹±æ–‡ Token æ¶ˆè€—å¯¹æ¯”

### Token è®¡ç®—è§„åˆ™

```python
ä¸­æ–‡ tokens â‰ˆ æ±‰å­—æ•° Ã— 2.5 + æ ‡ç‚¹æ•° Ã— 1
è‹±æ–‡ tokens â‰ˆ å•è¯æ•° Ã— 1.3

# åŒç­‰å«ä¹‰çš„è‹±æ–‡, æ¯”ä¸­æ–‡èŠ‚çº¦ 20%~40% çš„token
```

python

```python
# è‹±æ–‡ï¼šé€šå¸¸ 1 ä¸ªå•è¯ â‰ˆ 1-2 tokens
"Get the current weather" = 4-5 tokens

# ä¸­æ–‡ï¼šé€šå¸¸ 1 ä¸ªæ±‰å­— â‰ˆ 1.5-3 tokensï¼ˆå–å†³äºåˆ†è¯å™¨ï¼‰
"è·å–å½“å‰å¤©æ°”" = 6-12 tokens
```

### å®é™…æµ‹è¯•å¯¹æ¯”

python

```python
# è‹±æ–‡ç‰ˆæœ¬
functions_en = [{
    'name': 'get_weather',
    'description': 'Get current weather for a location',
    'parameters': {
        'properties': {
            'location': {'type': 'string', 'description': 'City name'},
            'unit': {'type': 'string', 'enum': ['celsius', 'fahrenheit']}
        },
        'required': ['location']
    }
}]
# é¢„ä¼°: ~70 tokens

# ä¸­æ–‡ç‰ˆæœ¬
functions_cn = [{
    'name': 'get_weather',
    'description': 'è·å–æŒ‡å®šåœ°ç‚¹çš„å½“å‰å¤©æ°”',
    'parameters': {
        'properties': {
            'location': {'type': 'string', 'description': 'åŸå¸‚åç§°'},
            'unit': {'type': 'string', 'enum': ['æ‘„æ°åº¦', 'åæ°åº¦']}
        },
        'required': ['location']
    }
}]
# é¢„ä¼°: ~90-110 tokens

# ç»“è®ºï¼šè‹±æ–‡ç‰ˆæœ¬çœ 20-40% çš„ tokensï¼
```

### ä¸ºä»€ä¹ˆè‹±æ–‡æ›´çœï¼Ÿ

python

```python
# åŸå›  1ï¼šç¼–ç æ•ˆç‡
# GPT ç³»åˆ—çš„ tokenizer æ˜¯åŸºäºè‹±æ–‡ä¼˜åŒ–çš„
è‹±æ–‡ "Get weather" = 2 tokens
ä¸­æ–‡ "è·å–å¤©æ°”" = 4-6 tokens

# åŸå›  2ï¼šå­—ç¬¦å¯†åº¦
è‹±æ–‡ "location" = 1 token
ä¸­æ–‡ "ä½ç½®" = 2-3 tokens

# åŸå›  3ï¼šæšä¸¾å€¼
è‹±æ–‡ ['celsius', 'fahrenheit'] = 2 tokens
ä¸­æ–‡ ['æ‘„æ°åº¦', 'åæ°åº¦'] = 4-6 tokens
```